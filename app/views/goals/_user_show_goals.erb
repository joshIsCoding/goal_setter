<section class="user-show-goals">
  <h3 class="show-goals-heading">Active Goals</h3>
  <ul class="active-goals">
  <% goals.incomplete.each do |goal| %>
  <li>
    <article class="user-show-goal">
      <aside class="up-vote-widget">
          <% if is_logged_in? && goal.user != current_user %>
            <% upvote = goal.get_up_vote(current_user) %>
            <% if upvote %>
                <%= render "up_votes/delete", goal: goal, upvote: upvote %>
            <% elsif current_user.has_up_votes_remaining? %>
                <%= render "up_votes/form", goal: goal %>
            <% end %>
          <% else %>
            <div class="dummy_up_vote"><%= ApplicationHelper::UP_VOTE_ICONS["up"].
              html_safe %>
            </div>
          <% end %>
          <data class="up-vote-count" value="<%= goal.up_votes_count %>"><%= goal.up_votes_count %>
          </data>
        </aside>
      <header>
      <p class="goal-status">
        <%= (GoalsHelper::STATUS_ICONS[goal.status.downcase.gsub(" ", "-")] + 
          "<span class=\"sr-only\">#{goal.status}</span>").html_safe %>
      </p>
      </header>
      <h4 class="goal-title"><!--
      --><%= link_to goal.title, 
        goal_url(goal), 
        class: "container-link" %>
      </h4>
      <a href="<%= goal_url(goal) %>" class="container-link">
        <ul class="category-icons">
        <% unless goal.categories.empty? %>
          <% goal.categories.each do |category| %>
          <li><%= (GoalsHelper::CATEGORY_ICONS[category.name.downcase] +
            "<span class=\"sr-only\">#{category.name}</span>").html_safe %>
          </li>
          <% end %>
        <% end %>
        </ul>
      </a>
      <footer>
      <a class="comment-count" href="<%= goal_url(goal)+"#comments"%>">
          <%= goal.comments_count.to_s + (goal.comments_count == 1 ? 
              " comment" : " comments") %>
        </a>
      <% if is_current_user %>
        <%= render "goals/user_controls", goal: goal %>
        <% else %>
          <small class="creation-time">set <time datetime="<%= goal.created_at.strftime("%Y-%m-%dT%H:%M") %>"><!--
          --> <%= time_ago_in_words(goal.created_at).sub("about", "") %> ago</small>
        <% end %>
      </footer>
    </article>
  </li>
  <% end %>
  </ul>

  <h3 class="show-goals-heading">Completed Goals</h3>
  <ul class="completed-goals">
<% goals.complete.each do |goal| %>
    <li>
      <article class="user-show-goal completed">
      <aside class="up-vote-widget">
          <% if is_logged_in? && goal.user != current_user %>
            <% upvote = goal.get_up_vote(current_user) %>
            <% if upvote %>
                <%= render "up_votes/delete", goal: goal, upvote: upvote %>
            <% elsif current_user.has_up_votes_remaining? %>
                <%= render "up_votes/form", goal: goal %>
            <% end %>
          <% else %>
            <div class="dummy_up_vote"><%= ApplicationHelper::UP_VOTE_ICONS["up"].
              html_safe %>
            </div>
          <% end %>
          <data class="up-vote-count" value="<%= goal.up_votes_count %>"><%= goal.up_votes_count %>
          </data>
        </aside>
      <header>
      <p class="goal-status">
        <%= (GoalsHelper::STATUS_ICONS[goal.status.downcase.gsub(" ", "-")] + 
          "<span class=\"sr-only\">#{goal.status}</span>").html_safe %>
      </p>
      </header>
      <h4 class="goal-title"><!--
      --><%= link_to goal.title, 
            goal_url(goal), 
            class: "container-link" %>
      </h4>
      <a href="<%= goal_url(goal) %>" class="container-link">
        <ul class="category-icons">
        <% unless goal.categories.empty? %>
          <% goal.categories.each do |category| %>
          <li><%= (GoalsHelper::CATEGORY_ICONS[category.name.downcase] +
            "<span class=\"sr-only\">#{category.name}</span>").html_safe %>
          </li>
          <% end %>
        <% end %>
        </ul>
      </a>
      <footer>
      <a class="comment-count" href="<%= goal_url(goal)+"#comments"%>">
          <%= goal.comments_count.to_s + (goal.comments_count == 1 ? 
              " comment" : " comments") %>
        </a>
      <% if is_current_user %>
        <%= render "goals/user_controls", goal: goal %>
      <% else %>
        <small class="creation-time">set <time datetime="<%= goal.created_at.strftime("%Y-%m-%dT%H:%M") %>"><!--
        --> <%= time_ago_in_words(goal.created_at).sub("about", "") %> ago</small>
      <% end %>
      </footer>
    </article>
    </li>
    <% end %>
  </ul>
  
</section>